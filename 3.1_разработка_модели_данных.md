# 3.1 Разработка модели данных

Модель данных разработана с учетом требований нормализации базы данных до третьей нормальной формы (3NF) для обеспечения целостности данных и устранения избыточности.

## 3.1.1 Концептуальная модель данных

Концептуальная модель представляет основные сущности предметной области и связи между ними:

**Основные сущности:**

1. **Exhibit (Экспонат)** — основная сущность, представляющая студенческую работу
2. **Supervisor (Научный руководитель)** — сущность, представляющая преподавателя-руководителя
3. **PageContent (Контент страниц)** — сущность для хранения редактируемого текстового контента сайта

**Связи между сущностями:**

- **Exhibit ↔ Supervisor**: связь "многие-к-одному" (Many-to-One)
  - Один научный руководитель может курировать множество экспонатов
  - Каждый экспонат имеет одного научного руководителя (опционально)
  - Реализована через внешний ключ `supervisorId` в таблице `Exhibit`

## 3.1.2 Логическая модель данных

Логическая модель реализована в виде реляционной схемы базы данных SQLite с использованием Prisma ORM.

**Таблица Exhibit:**

Основная таблица для хранения информации об экспонатах. Содержит следующие поля:

- `id` (String, UUID) — первичный ключ, уникальный идентификатор экспоната
- `inventoryNumber` (String, nullable) — инвентарный номер фонда/музея
- `title` (String) — название экспоната (обязательное поле)
- `description` (String) — краткое описание для превью/карточки (обязательное поле)
- `fullDescription` (String, nullable) — полное описание: история создания, стилистика, символика
- `creationDate` (String, nullable) — дата создания работы
- `studentName` (String, nullable) — ФИО студента-автора
- `studentCourse` (String, nullable) — курс студента
- `studentGroup` (String, nullable) — группа студента
- `supervisorId` (String, nullable) — внешний ключ к таблице Supervisor
- `dimensions` (String, nullable) — размеры (ВхШхГ) или диаметр
- `currentLocation` (String, nullable) — текущее местонахождение (экспозиция, запасник)
- `isPublic` (Boolean, default: true) — флаг публичности экспоната
- `category` (String) — категория экспоната (обязательное поле)
- `year` (String, nullable) — год создания (для обратной совместимости)
- `modelPath` (String, nullable) — путь к 3D модели (GLB/GLTF)
- `has3DModel` (Boolean, default: false) — флаг наличия 3D модели
- `previewImage` (String, nullable) — путь к превью-изображению
- `images` (String, JSON array) — массив путей к изображениям галереи
- `creationInfo` (String, nullable) — информация о создании работы
- `technicalSpecs` (String, JSON object) — технические характеристики
- `interestingFacts` (String, JSON array) — интересные факты
- `relatedExhibits` (String, JSON array) — связанные экспонаты
- `galleryPositionX` (Float, nullable) — координата X в виртуальной галерее
- `galleryPositionY` (Float, nullable, default: 0) — координата Y в виртуальной галерее
- `galleryPositionZ` (Float, nullable) — координата Z в виртуальной галерее
- `galleryScale` (Float, nullable, default: 1.0) — масштаб экспоната в галерее
- `galleryRotationY` (Float, nullable, default: 0) — поворот экспоната по оси Y
- `visibleInGallery` (Boolean, default: true) — видимость в виртуальной галерее
- `createdAt` (DateTime) — дата создания записи
- `updatedAt` (DateTime) — дата последнего обновления

**Индексы:**
- `category` — для быстрого поиска по категориям
- `year` — для фильтрации по годам
- `studentName` — для поиска по автору
- `supervisorId` — для связи с таблицей Supervisor
- `visibleInGallery` — для фильтрации экспонатов в галерее
- `isPublic` — для фильтрации публичных экспонатов

**Таблица Supervisor:**

Таблица для хранения информации о научных руководителях. Выделена в отдельную таблицу для соответствия 3NF и устранения транзитивных зависимостей.

- `id` (String, UUID) — первичный ключ
- `name` (String, unique) — ФИО научного руководителя (уникальное поле)
- `position` (String, nullable) — должность
- `rank` (String, nullable) — звание
- `department` (String, nullable) — кафедра
- `createdAt` (DateTime) — дата создания записи
- `updatedAt` (DateTime) — дата последнего обновления
- `exhibits` (Relation) — связь с экспонатами (один-ко-многим)

**Индексы:**
- `name` (unique) — для быстрого поиска по имени и обеспечения уникальности

**Таблица PageContent:**

Таблица для хранения редактируемого контента страниц сайта.

- `id` (String, default: "singleton") — первичный ключ, всегда "singleton"
- `content` (String, JSON) — JSON-структура с контентом страниц
- `updatedAt` (DateTime) — дата последнего обновления

## 3.1.3 Нормализация базы данных

База данных приведена к третьей нормальной форме (3NF):

**Устранение транзитивных зависимостей:**

Информация о научных руководителях (должность, звание, кафедра) вынесена в отдельную таблицу `Supervisor`, так как эти атрибуты зависят от самого руководителя, а не напрямую от экспоната. Это устраняет:
- Дублирование данных (один руководитель может курировать множество экспонатов)
- Аномалии обновления (изменение должности требует обновления одной записи)
- Аномалии удаления (информация о руководителе сохраняется при удалении экспонатов)
- Риск несогласованности данных

**Преимущества нормализации:**

- Обеспечение целостности данных через внешние ключи
- Устранение избыточности информации
- Упрощение обновления данных
- Улучшение производительности запросов за счет индексов
